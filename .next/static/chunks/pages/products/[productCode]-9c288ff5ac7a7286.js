(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2070],{81762:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/products/[productCode]",function(){return r(58477)}])},86078:function(e,n,r){"use strict";var t=r(47568),i=r(97582),s=r(85893),a=r(11163),c=r(67294),o=r(5121);n.Z=function(e){var n=e.children,r=(0,a.useRouter)();return(0,c.useEffect)((function(){var e=function(){var e=(0,t.Z)((function(){var e,n,t;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e=sessionStorage.getItem("token")))return r.push("/login"),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.Z.get("".concat("http://3.83.33.251:5000","/api/public/user-type"),{headers:{Authorization:"Bearer ".concat(e)},withCredentials:!0})];case 2:return n=i.sent(),console.log(n.data),"false"===n.data?r.push("/login"):"member"===n.data&&r.push("/user"),[3,4];case 3:return t=i.sent(),console.error("Error checking authentication:",t),r.push("/login"),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}();e()}),[r]),(0,s.jsx)(s.Fragment,{children:n})}},58477:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return L}});var t=r(47568),i=r(97582),s=r(85893),a=r(67294),c=r(5121),o=r(11163),l=r(41664),d=r.n(l),h=r(86886),x=r(66242),u=r(15861),Z=r(44267),j=r(69417),p=r(5616),m=r(90948),g=(r(75787),r(90629)),f=r(7906),y=r(57922),v=r(53816),b=r(53184),P=r(295),C=r(98102),D=r(93946),w=r(72882),S=r(23246),_=r(22875),k=function(e){var n=e.row,r=(0,a.useState)(!1),t=r[0],i=r[1];return(0,s.jsxs)(a.Fragment,{children:[(0,s.jsxs)(v.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,s.jsx)(C.Z,{children:(0,s.jsx)(D.Z,{"aria-label":"expand row",size:"small",onClick:function(){return i(!t)},children:t?(0,s.jsx)(S.Z,{}):(0,s.jsx)(_.Z,{})})}),(0,s.jsx)(C.Z,{children:n.transactionId}),(0,s.jsx)(C.Z,{align:"center",children:n.productId}),(0,s.jsx)(C.Z,{align:"center",children:n.transactionType}),(0,s.jsx)(C.Z,{align:"center",children:n.amountPurchased}),(0,s.jsx)(C.Z,{align:"center",children:n.realWeight}),(0,s.jsx)(C.Z,{align:"center",children:n.transactionDate})]}),(0,s.jsx)(v.Z,{sx:{background:"#fafafa"},children:(0,s.jsx)(C.Z,{colSpan:7,sx:{py:"0 !important"},children:(0,s.jsx)(y.Z,{in:t,timeout:"auto",unmountOnExit:!0,children:(0,s.jsxs)(p.Z,{sx:{m:2,pb:6},children:[(0,s.jsx)(u.Z,{variant:"body1",gutterBottom:!0,component:"div",sx:{py:2},children:"More Details"}),(0,s.jsxs)(f.Z,{size:"small","aria-label":"details",children:[(0,s.jsx)(b.Z,{children:(0,s.jsxs)(v.Z,{children:[(0,s.jsx)(C.Z,{align:"center",children:"Purchased Price per gram"}),(0,s.jsx)(C.Z,{align:"center",children:"Dispense Price per gram"}),(0,s.jsx)(C.Z,{align:"center",children:"Total Purchase Price"}),(0,s.jsx)(C.Z,{align:"center",children:"Total Dispense Price"}),(0,s.jsx)(C.Z,{align:"center",children:"Created by"}),(0,s.jsx)(C.Z,{align:"center",children:"Comments"})]})}),(0,s.jsx)(P.Z,{children:(0,s.jsxs)(v.Z,{children:[(0,s.jsx)(C.Z,{align:"center",children:n.purchasePricePerGram}),(0,s.jsx)(C.Z,{align:"center",children:n.dispensePricePerGram}),(0,s.jsx)(C.Z,{align:"center",children:n.totalPurchasePrice}),(0,s.jsx)(C.Z,{align:"center",children:n.totalDispensePrice}),(0,s.jsx)(C.Z,{align:"center",children:n.createdBy}),(0,s.jsx)(C.Z,{align:"center",children:n.comments})]})})]})]})})})})]})},B=function(e){var n=e.data;return n&&Array.isArray(n)&&0!==n.length?(0,s.jsx)(w.Z,{component:g.Z,children:(0,s.jsxs)(f.Z,{"aria-label":"collapsible table",children:[(0,s.jsx)(b.Z,{children:(0,s.jsxs)(v.Z,{children:[(0,s.jsx)(C.Z,{}),(0,s.jsx)(C.Z,{children:"Transaction ID"}),(0,s.jsx)(C.Z,{align:"center",children:"Product ID"}),(0,s.jsx)(C.Z,{align:"center",children:"Transaction Type"}),(0,s.jsx)(C.Z,{align:"center",children:"Amount Purchased"}),(0,s.jsx)(C.Z,{align:"center",children:"Real Weight"}),(0,s.jsx)(C.Z,{align:"center",children:"Transaction Date"})]})}),(0,s.jsx)(P.Z,{children:n.map((function(e){return(0,s.jsx)(k,{row:e},e._id)}))})]})}):(0,s.jsx)("p",{children:"No data available."})},N=r(44960),T=r(86078),I=r(50657),E=r(31425),A=r(6514),W=r(58951),R=r(37645),z=(0,m.ZP)("img")((function(e){var n=e.theme;return{width:150,height:150,marginRight:n.spacing(6.25),borderRadius:n.shape.borderRadius}})),F=function(e){if(!e||isNaN(new Date(e)))return"";return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric"})},L=function(){var e,n=(0,a.useState)([]),r=n[0],l=n[1],m=(0,a.useState)("/images/avatars/1.png"),g=(m[0],m[1],(0,a.useState)(null)),f=g[0],y=g[1],v=(0,a.useState)(null),b=v[0],P=v[1],C=(0,a.useState)(null),D=C[0],w=C[1],S=(0,a.useState)(!1),_=S[0],k=S[1],L=(0,o.useRouter)(),O="undefined"!==typeof sessionStorage?sessionStorage.getItem("token"):null,H=function(){k(!1)},M=function(){var e=(0,t.Z)((function(){var e,n,r,t;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(e=L.query.productCode)?(n="".concat("http://3.83.33.251:5000","/api/protected/cannabisProducts/").concat(e),[4,c.Z.delete(n,{headers:{Authorization:"Bearer ".concat(O)},withCredentials:!0})]):(console.error("Product code is missing."),[2]);case 1:return 200===(r=i.sent()).status?(console.log("Product deleted successfully."),L.push("/products")):console.error("Error deleting product:",r.data),[3,3];case 2:return t=i.sent(),console.error("Error deleting product:",t),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){var e=function(){var e=(0,t.Z)((function(){var e,n,r;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),(e=L.query.productCode)?(P(e),[4,c.Z.get("".concat("http://3.83.33.251:5000","/api/protected/cannabisProducts/").concat(e),{headers:{Authorization:"Bearer ".concat(O)},withCredentials:!0})]):[2];case 1:return(n=t.sent()).data&&y(n.data),[3,3];case 2:return r=t.sent(),console.error("Error fetching product data:",r),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();e();var n=function(){var e=(0,t.Z)((function(){var e,n,r,t;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:e=L.query.productCode,n=e,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,c.Z.get("".concat("http://3.83.33.251:5000","/api/protected/cannabisTransactions"),{params:{productId:n},headers:{Authorization:"Bearer ".concat(O)},withCredentials:!0})];case 2:return(r=i.sent()).data&&r.data.length>0&&l(r.data),[3,4];case 3:return t=i.sent(),console.error("Error fetching transaction data:",t),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),r=function(){var e=(0,t.Z)((function(){var e,n,r,t;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:e=L.query.productCode,n=e,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,c.Z.get("".concat("http://3.83.33.251:5000","/api/protected/dispenseTransactions"),{params:{productId:n},headers:{Authorization:"Bearer ".concat(O)},withCredentials:!0})];case 2:return(r=i.sent()).data&&r.data.length>0&&w(r.data),console.log(r.data),[3,4];case 3:return t=i.sent(),console.error("Error fetching transaction data:",t),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}();r(),n()}),[L.query.productCode]),f?(0,s.jsxs)(T.Z,{children:[(0,s.jsxs)(h.ZP,{container:!0,spacing:6,children:[(0,s.jsx)(h.ZP,{item:!0,xs:12,children:(0,s.jsx)(x.Z,{sx:{p:5},children:(0,s.jsx)(Z.Z,{children:(0,s.jsxs)(h.ZP,{container:!0,spacing:5,children:[(0,s.jsx)(h.ZP,{item:!0,xs:12,children:(0,s.jsx)(u.Z,{variant:"h5",children:"Product Information"})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,sx:{marginTop:4.8,marginBottom:3},children:(0,s.jsxs)(p.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(z,{src:(e=f.imageURL,"string"===typeof e?""===e?"/images/avatars/cannabis-product-default.jpg":e.replace(/\\/g,"/"):(console.error("Image URL must be a string."),null)),alt:"Profile Pic"}),(0,s.jsxs)(p.Z,{children:[(0,s.jsx)(u.Z,{variant:"h5",sx:{mb:4},children:f.name}),(0,s.jsxs)(u.Z,{variant:"subtitle1",children:["Sale Price: ",f.salePrice]}),(0,s.jsx)(u.Z,{variant:"body2",color:f.stock?"success.main":"error",children:f.stock?"".concat(f.stock," in stock"):"Out of stock"})]})]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,sx:{marginTop:4.8,marginBottom:3},children:(0,s.jsxs)(p.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[(0,s.jsx)(d(),{href:"/products/edit/".concat(b),passHref:!0,children:(0,s.jsx)(j.Z,{size:"large",variant:"contained",href:"#text-buttons",children:"Edit Product"})}),(0,s.jsx)(j.Z,{color:"error",sx:{ml:5},size:"large",variant:"contained",href:"#text-buttons",onClick:function(){k(!0)},children:"Delete Product"})]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Category:"})," ",f.category]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Date Created:"})," ",F(f.createdAt)]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Second Breed:"})," ",f.secondBreed]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Type:"})," ",f.type]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"% Sativa:"})," ",f.sativaPercent]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"% THC:"})," ",f.THCpercent]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"% CBD:"})," ",f.CBDpercent]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"% CBN:"})," ",f.CBNpercent]})}),(0,s.jsx)(h.ZP,{item:!0,xs:6,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Description:"})," ",f.description]})}),(0,s.jsx)(h.ZP,{item:!0,sm:6,xs:12,children:(0,s.jsxs)(u.Z,{variant:"body1",children:[(0,s.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Medical Description"})," ",f.medDescription]})})]})})})}),(0,s.jsx)(h.ZP,{item:!0,sm:12,xs:12,sx:{mt:6},children:(0,s.jsx)(x.Z,{sx:{p:5},children:(0,s.jsxs)(Z.Z,{children:[(0,s.jsx)(u.Z,{variant:"h5",children:"Purchase Stock History"}),(0,s.jsx)(B,{data:r})]})})}),(0,s.jsx)(h.ZP,{item:!0,sm:12,xs:12,children:(0,s.jsx)(x.Z,{sx:{p:5},children:(0,s.jsxs)(Z.Z,{children:[(0,s.jsx)(u.Z,{variant:"h5",children:"Dispense History"}),(0,s.jsx)(N.Z,{data:D}),(0,s.jsx)(u.Z,{variant:"body1",sx:{mt:4},children:"No data yet"})]})})})]}),(0,s.jsxs)(I.Z,{open:_,onClose:H,children:[(0,s.jsx)(R.Z,{children:"Confirm Deletion"}),(0,s.jsx)(A.Z,{children:(0,s.jsx)(W.Z,{children:"Are you sure you want to delete this product?"})}),(0,s.jsxs)(E.Z,{children:[(0,s.jsx)(j.Z,{onClick:H,children:"Cancel"}),(0,s.jsx)(j.Z,{color:"error",onClick:M,children:"Confirm Delete"})]})]})]}):(0,s.jsx)("p",{children:"Loading..."})}},44960:function(e,n,r){"use strict";var t=r(85893),i=r(67294),s=r(5616),a=r(90629),c=r(7906),o=r(57922),l=r(53816),d=r(53184),h=r(295),x=r(98102),u=r(15861),Z=r(93946),j=r(72882),p=r(23246),m=r(22875),g=function(e){var n=e.row,r=(0,i.useState)(!1),a=r[0],j=r[1];return(0,t.jsxs)(i.Fragment,{children:[(0,t.jsxs)(l.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,t.jsx)(x.Z,{children:(0,t.jsx)(Z.Z,{"aria-label":"expand row",size:"small",onClick:function(){return j(!a)},children:a?(0,t.jsx)(p.Z,{}):(0,t.jsx)(m.Z,{})})}),(0,t.jsx)(x.Z,{children:n.transactionId}),(0,t.jsx)(x.Z,{align:"center",children:n.memberCode}),(0,t.jsx)(x.Z,{align:"center",children:n.transactionType}),(0,t.jsx)(x.Z,{align:"center",children:n.amountTotal}),(0,t.jsx)(x.Z,{align:"center",children:new Date(n.checkoutDate).toLocaleDateString()}),(0,t.jsx)(x.Z,{align:"center",children:n.createdBy})]}),(0,t.jsx)(l.Z,{sx:{background:"#fafafa"},children:(0,t.jsx)(x.Z,{colSpan:7,sx:{py:"0 !important"},children:(0,t.jsx)(o.Z,{in:a,timeout:"auto",unmountOnExit:!0,children:(0,t.jsxs)(s.Z,{sx:{m:2,pb:6},children:[(0,t.jsx)(u.Z,{variant:"body1",gutterBottom:!0,component:"div",sx:{py:2},children:"Products Dispensed"}),(0,t.jsxs)(c.Z,{size:"small","aria-label":"products",children:[(0,t.jsx)(d.Z,{children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(x.Z,{align:"center",children:"Name"}),(0,t.jsx)(x.Z,{align:"center",children:"Category"}),(0,t.jsx)(x.Z,{align:"center",children:"Sale Price"}),(0,t.jsx)(x.Z,{align:"center",children:"Weight"}),(0,t.jsx)(x.Z,{align:"center",children:"Subtotal"})]})}),(0,t.jsx)(h.Z,{children:n.products.map((function(e,n){return(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(x.Z,{align:"center",children:e.name}),(0,t.jsx)(x.Z,{align:"center",children:e.category}),(0,t.jsx)(x.Z,{align:"center",children:e.salePrice}),(0,t.jsx)(x.Z,{align:"center",children:e.weight}),(0,t.jsx)(x.Z,{align:"center",children:e.subtotal})]},n)}))})]}),(0,t.jsx)(u.Z,{variant:"body1",gutterBottom:!0,component:"div",sx:{py:2,mt:4},children:"Comments"}),(0,t.jsx)(u.Z,{variant:"body2",children:n.comments})]})})})})]})};n.Z=function(e){var n=e.data;return n&&Array.isArray(n)&&0!==n.length?(0,t.jsx)(j.Z,{component:a.Z,children:(0,t.jsxs)(c.Z,{"aria-label":"collapsible table",children:[(0,t.jsx)(d.Z,{children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(x.Z,{}),(0,t.jsx)(x.Z,{children:"Transaction ID"}),(0,t.jsx)(x.Z,{align:"center",children:"Member Code"}),(0,t.jsx)(x.Z,{align:"center",children:"Transaction Type"}),(0,t.jsx)(x.Z,{align:"center",children:"Amount Total"}),(0,t.jsx)(x.Z,{align:"center",children:"Checkout Date"}),(0,t.jsx)(x.Z,{align:"center",children:"Created By"})]})}),(0,t.jsx)(h.Z,{children:n.map((function(e){return(0,t.jsx)(g,{row:e},e._id.$oid)}))})]})}):(0,t.jsx)("p",{children:"No data available."})}},75787:function(e,n,r){"use strict";var t=r(85893),i=r(67294),s=r(41664),a=r.n(s),c=r(90629),o=r(7906),l=r(53816),d=r(53184),h=r(295),x=r(98102),u=r(72882),Z=r(70519),j=function(e){if(!e||isNaN(new Date(e)))return"";return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric"})},p=function(e){var n=new Date(e),r=new Date,t=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return i<0||0===i&&r.getDate()<n.getDate()?t-1:t};n.Z=function(e){var n=e.data,r=(0,i.useState)(0),s=r[0],m=r[1],g=(0,i.useState)(5),f=g[0],y=g[1];if(!n||!Array.isArray(n)||0===n.length)return(0,t.jsx)("p",{children:"No data available."});var v=s>0?Math.max(0,(1+s)*f-n.length):0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{component:c.Z,children:(0,t.jsxs)(o.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,t.jsx)(d.Z,{children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(x.Z,{children:"ID"}),(0,t.jsx)(x.Z,{children:"First Name"}),(0,t.jsx)(x.Z,{children:"Last Name"}),(0,t.jsx)(x.Z,{children:"Credits"}),(0,t.jsx)(x.Z,{children:"Gender"}),(0,t.jsx)(x.Z,{children:"Registered"}),(0,t.jsx)(x.Z,{children:"Age"}),(0,t.jsx)(x.Z,{children:"ID Number"}),(0,t.jsx)(x.Z,{children:"User Role"}),(0,t.jsx)(x.Z,{children:"Email"}),(0,t.jsx)(x.Z,{children:"Expiry"})]})}),(0,t.jsxs)(h.Z,{children:[n.slice(s*f,s*f+f).map((function(e){var n,r,i;return(0,t.jsx)(a(),{href:"/members/profile/".concat(e.memberCode),passHref:!0,children:(0,t.jsxs)(l.Z,{component:"a",sx:{cursor:"pointer",textDecoration:"none","&:hover":{backgroundColor:"#f5f5f5"},"&:last-of-type td, &:last-of-type th":{border:0}},children:[(0,t.jsx)(x.Z,{component:"th",scope:"row",children:e.memberCode}),(0,t.jsx)(x.Z,{children:e.firstName}),(0,t.jsx)(x.Z,{children:e.lastName}),(0,t.jsx)(x.Z,{children:e.credits}),(0,t.jsx)(x.Z,{children:e.gender}),(0,t.jsx)(x.Z,{children:j(null===(n=e.userInfo[0])||void 0===n?void 0:n.createdAt)}),(0,t.jsx)(x.Z,{children:p(e.dateOfBirth)}),(0,t.jsx)(x.Z,{children:e.idNumber}),(0,t.jsx)(x.Z,{children:null===(r=e.userInfo[0])||void 0===r?void 0:r.userRole}),(0,t.jsx)(x.Z,{children:null===(i=e.userInfo[0])||void 0===i?void 0:i.email}),(0,t.jsx)(x.Z,{children:j(e.expiryDate)})]})},e.memberCode)})),v>0&&(0,t.jsx)(l.Z,{style:{height:53*v},children:(0,t.jsx)(x.Z,{colSpan:11})})]})]})}),(0,t.jsx)(Z.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:n.length,rowsPerPage:f,page:s,onPageChange:function(e,n){m(n)},onRowsPerPageChange:function(e){y(parseInt(e.target.value,10)),m(0)}})]})}}},function(e){e.O(0,[2657,7709,8360,9254,519,46,75,9774,2888,179],(function(){return n=81762,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
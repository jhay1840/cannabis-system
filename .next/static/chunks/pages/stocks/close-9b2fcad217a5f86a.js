(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4405],{29862:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/stocks/close",function(){return n(42205)}])},86078:function(t,e,n){"use strict";var r=n(47568),a=n(97582),s=n(85893),i=n(11163),o=n(67294),c=n(5121);e.Z=function(t){var e=t.children,n=(0,i.useRouter)();return(0,o.useEffect)((function(){var t=function(){var t=(0,r.Z)((function(){var t,e,r;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(!(t=sessionStorage.getItem("token")))return n.push("/login"),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,c.Z.get("".concat("http://localhost:5000","/api/public/user-type"),{headers:{Authorization:"Bearer ".concat(t)},withCredentials:!0})];case 2:return e=a.sent(),console.log(e.data),"false"===e.data?n.push("/login"):"member"===e.data&&n.push("/user"),[3,4];case 3:return r=a.sent(),console.error("Error checking authentication:",r),n.push("/login"),[3,4];case 4:return[2]}}))}));return function(){return t.apply(this,arguments)}}();t()}),[n]),(0,s.jsx)(s.Fragment,{children:e})}},42205:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return E}});var r=n(47568),a=n(26042),s=n(69396),i=n(10797),o=n(97582),c=n(85893),u=n(67294),l=n(5121),d=n(11163),h=n(86886),f=n(50135),p=n(87109),Z=n(66242),x=n(15861),y=n(78445),g=n(44267),j=n(69417),m=n(45185),v=n(86078),_=n(14924),D=n(90629),b=n(7906),P=n(53816),O=n(53184),Q=n(295),S=n(98102),k=n(72882),C=function(t){var e=t.data,n=t.setTableData,r=function(t,r,i){var o=e.map((function(e){return e._id===r?(0,s.Z)((0,a.Z)({},e),(0,_.Z)({},i,t.target.value)):e}));n(o)};return e&&Array.isArray(e)&&0!==e.length?(0,c.jsx)(k.Z,{component:D.Z,children:(0,c.jsxs)(b.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,c.jsx)(O.Z,{children:(0,c.jsxs)(P.Z,{children:[(0,c.jsx)(S.Z,{children:"Product ID"}),(0,c.jsx)(S.Z,{children:"Product Name"}),(0,c.jsx)(S.Z,{children:"End of the Day Qty"}),(0,c.jsx)(S.Z,{children:"Start of the Day Qty"}),(0,c.jsx)(S.Z,{children:"Usage"}),(0,c.jsx)(S.Z,{children:"Remove"})]})}),(0,c.jsx)(Q.Z,{children:e.map((function(t){return(0,c.jsxs)(P.Z,{children:[(0,c.jsx)(S.Z,{component:"th",scope:"row",children:t._id}),(0,c.jsx)(S.Z,{children:t.name}),(0,c.jsx)(S.Z,{children:(0,c.jsx)(f.Z,{value:t.endOfDayQty,onChange:function(e){return r(e,t._id,"endOfDayQty")},variant:"outlined",size:"small",type:"number"})}),(0,c.jsx)(S.Z,{children:(0,c.jsx)(f.Z,{value:t.startOfDayQty,onChange:function(e){return r(e,t._id,"startOfDayQty")},variant:"outlined",size:"small",type:"number"})}),(0,c.jsx)(S.Z,{children:t.startOfDayQty-t.endOfDayQty}),(0,c.jsx)(S.Z,{children:(0,c.jsx)(j.Z,{variant:"outlined",color:"error",onClick:function(){return function(t){var r=e.filter((function(e){return e._id!==t}));n(r)}(t._id)},children:"Remove"})})]},t._id)}))})]})}):(0,c.jsx)("p",{children:"Add Products"})},w=n(69497),E=function(){var t=(0,u.useState)(""),e=t[0],n=t[1],_=(0,u.useState)([]),D=_[0],b=_[1],P=(0,u.useState)([]),O=P[0],Q=P[1],S=(0,u.useState)(null),k=S[0],E=S[1],A=(0,d.useRouter)(),I=(0,u.useState)(function(){var t=new Date,e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return"".concat(e,"-").concat(n,"-").concat(r)}()),N=I[0],z=I[1],T="undefined"!==typeof sessionStorage?sessionStorage.getItem("token"):null;(0,u.useEffect)((function(){if(e.length>2){var t=function(){var t=(0,r.Z)((function(){var t,n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,l.Z.get("".concat("http://localhost:5000","/api/protected/cannabisProducts"),{params:{search:e},headers:{Authorization:"Bearer ".concat(T)},withCredentials:!0})];case 1:return t=r.sent(),b(t.data),[3,3];case 2:return n=r.sent(),console.error("Error fetching product suggestions:",n),[3,3];case 3:return[2]}}))}));return function(){return t.apply(this,arguments)}}();t()}else b([])}),[e]);var R=function(){var t=(0,r.Z)((function(){var t,e;return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),O.some((function(t){return!t.endOfDayQty}))||O.some((function(t){return!t.startOfDayQty}))?(alert("Please fill in all fields before saving."),[2]):O.some((function(t){return Number(t.endOfDayQty)>Number(t.startOfDayQty)}))?(alert("End of day quantity cannot be greater than start of day quantity."),[2]):(t=O.map((function(t){return{productId:t._id,name:t.name,endOfDayQty:t.endOfDayQty,startOfDayQty:t.startOfDayQty,usage:t.usage,closeDate:N}})),[4,l.Z.post("".concat("http://localhost:5000","/api/protected/saveClosingStock"),t,{headers:{Authorization:"Bearer ".concat(T)},withCredentials:!0})]);case 1:return n.sent(),console.log("Data saved successfully"),A.push("/sales-report"),[3,3];case 2:return e=n.sent(),console.error("Error saving data:",e),[3,3];case 3:return[2]}}))}));return function(){return t.apply(this,arguments)}}();return(0,c.jsx)(v.Z,{children:(0,c.jsxs)(h.ZP,{container:!0,spacing:6,children:[(0,c.jsx)(h.ZP,{item:!0,xs:6,children:(0,c.jsx)(x.Z,{variant:"h5",children:"Add Closing stocks"})}),(0,c.jsx)(h.ZP,{item:!0,xs:6,children:(0,c.jsx)(h.ZP,{item:!0,xs:12,sx:{},children:(0,c.jsx)(f.Z,{fullWidth:!0,label:"Date",type:"date",value:N,onChange:function(t){return z(t.target.value)},InputProps:{startAdornment:(0,c.jsx)(p.Z,{position:"start"})},required:!0})})}),(0,c.jsx)(h.ZP,{item:!0,xs:12,children:(0,c.jsx)(Z.Z,{children:(0,c.jsx)(g.Z,{children:(0,c.jsxs)(h.ZP,{container:!0,spacing:5,children:[(0,c.jsx)(h.ZP,{item:!0,xs:12,children:(0,c.jsxs)("form",{onSubmit:function(t){t.preventDefault(),k&&!O.some((function(t){return t._id===k._id}))&&(Q((0,i.Z)(O).concat([(0,s.Z)((0,a.Z)({},k),{endOfDayQty:k.stock||0,startOfDayQty:k.stock||0})])),E(null),n(""))},children:[(0,c.jsx)(m.Z,{freeSolo:!0,options:D,getOptionLabel:function(t){return t.name},onChange:function(t,e){E(e)},inputValue:e,onInputChange:function(t,e){n(e)},renderInput:function(t){return(0,c.jsx)(f.Z,(0,s.Z)((0,a.Z)({},t),{fullWidth:!0,label:"Search Product",placeholder:"Product Name",InputProps:(0,s.Z)((0,a.Z)({},t.InputProps),{startAdornment:(0,c.jsx)(p.Z,{position:"start",children:(0,c.jsx)(w.Z,{})})})}))}}),(0,c.jsx)(j.Z,{type:"submit",variant:"contained",size:"large",sx:{mt:4},children:"Add"})]})}),(0,c.jsx)(h.ZP,{item:!0,xs:12})]})})})}),(0,c.jsx)(h.ZP,{item:!0,xs:12,children:(0,c.jsxs)(Z.Z,{sx:{p:5},children:[(0,c.jsx)(y.Z,{title:"Products",titleTypographyProps:{variant:"h6"}}),(0,c.jsx)(C,{data:O,setTableData:Q})]})}),(0,c.jsx)(j.Z,{type:"button",color:"success",variant:"contained",size:"large",sx:{mt:4},onClick:R,children:"Save Closing stocks"})]})})}}},function(t){t.O(0,[2657,7709,8360,3678,9254,5551,5345,6143,2362,9774,2888,179],(function(){return e=29862,t(t.s=e);var e}));var e=t.O();_N_E=e}]);
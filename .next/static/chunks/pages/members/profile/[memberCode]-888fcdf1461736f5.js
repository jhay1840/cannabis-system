(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9181],{74927:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/members/profile/[memberCode]",function(){return r(16916)}])},86078:function(e,n,r){"use strict";var t=r(47568),i=r(97582),s=r(85893),a=r(11163),c=r(67294),o=r(5121);n.Z=function(e){var n=e.children,r=(0,a.useRouter)();return(0,c.useEffect)((function(){var e=function(){var e=(0,t.Z)((function(){var e,n,t;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(!(e=sessionStorage.getItem("token")))return r.push("/login"),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.Z.get("".concat("http://localhost:5000","/api/public/user-type"),{headers:{Authorization:"Bearer ".concat(e)},withCredentials:!0})];case 2:return n=i.sent(),console.log(n.data),"false"===n.data?r.push("/login"):"member"===n.data&&r.push("/user"),[3,4];case 3:return t=i.sent(),console.error("Error checking authentication:",t),r.push("/login"),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}();e()}),[r]),(0,s.jsx)(s.Fragment,{children:n})}},16916:function(e,n,r){"use strict";r.r(n);var t=r(47568),i=r(14924),s=r(97582),a=r(85893),c=r(67294),o=r(5121),l=r(11163),d=r(41664),h=r.n(d),x=r(86886),u=r(66242),Z=r(15861),m=r(44267),j=r(69417),p=r(5616),f=r(90948),g=r(46901),y=r(92401),v=(r(75787),r(94429)),b=r(44960),w=r(4026),D=r(86078),P=((0,f.ZP)("img")((function(e){var n=e.theme;return{width:150,height:150,marginRight:n.spacing(6.25),borderRadius:n.shape.borderRadius}})),(0,f.ZP)(j.Z)((function(e){var n=e.theme;return(0,i.Z)({},n.breakpoints.down("sm"),{width:"100%",textAlign:"center"})})),function(e){if(!e||isNaN(new Date(e)))return"";return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric"})}),C=function(e){var n=new Date(e),r=new Date,t=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return i<0||0===i&&r.getDate()<n.getDate()?t-1:t};n.default=function(){var e,n,r,i,d=(0,c.useState)([]),f=(d[0],d[1],(0,c.useState)([])),N=f[0],I=f[1],B=(0,c.useState)([]),_=B[0],S=B[1],A=(0,c.useState)(""),E=A[0],T=A[1],k=(0,c.useState)(null),W=k[0],R=k[1],M=(0,c.useState)(null),z=M[0],F=M[1],L=(0,l.useRouter)(),O="undefined"!==typeof sessionStorage?sessionStorage.getItem("token"):null,q=function(){var e=(0,t.Z)((function(){var e,n,r,t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:e=L.query.memberCode,n=e,console.log(n),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.Z.get("".concat("http://localhost:5000","/api/protected/creditTransactions"),{params:{memberId:n},headers:{Authorization:"Bearer ".concat(O)},withCredentials:!0})];case 2:return(r=i.sent()).data&&I(r.data),console.log(r.data),[3,4];case 3:return t=i.sent(),console.error("Error fetching transaction data:",t),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),H=function(){var e=(0,t.Z)((function(){var e,n,r,t;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:e=L.query.memberCode,n=e,console.log(n),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,o.Z.get("".concat("http://localhost:5000","/api/protected/dispenseTransactions"),{params:{memberId:n},headers:{Authorization:"Bearer ".concat(O)},withCredentials:!0})];case 2:return(r=i.sent()).data&&S(r.data),console.log(r.data),[3,4];case 3:return t=i.sent(),console.error("Error fetching transaction data:",t),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=(0,t.Z)((function(){var e,n,r;return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=L.query.memberCode,[4,o.Z.get("".concat("http://localhost:5000","/api/protected/members/").concat(e),{headers:{Authorization:"Bearer ".concat(O)},withCredentials:!0})];case 1:return(n=t.sent()).data&&n.data.length>0&&(R(n.data[0]),F(e)),[3,3];case 2:return r=t.sent(),console.error("Error fetching member data:",r),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();if((0,c.useEffect)((function(){Y(),q(),H();T(window.location.origin)}),[L.query.memberCode]),!W)return(0,a.jsx)("p",{children:"Loading..."});var G=W.expiryDate,U=G&&new Date(G)<new Date,X=G?U?"Membership expired":"":"Expiry date not set";return(0,a.jsx)(D.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:6,children:[(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(u.Z,{sx:{p:5},children:(0,a.jsx)(m.Z,{children:(0,a.jsxs)(x.ZP,{container:!0,spacing:5,children:[(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(Z.Z,{variant:"h5",children:"Personal Information"})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,sx:{marginTop:4.8,marginBottom:3},children:(0,a.jsxs)(p.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,a.jsx)(w.Z,{qrLink:"".concat(E,"/members/profile/").concat(z)}),(0,a.jsxs)(p.Z,{children:[(0,a.jsxs)(Z.Z,{variant:"h6",children:[W.firstName," ",W.lastName]}),(0,a.jsxs)(Z.Z,{variant:"subtitle1",children:["Credits: ",W.credits]}),(0,a.jsxs)(Z.Z,{variant:"body2",children:[C(W.dateOfBirth)," y.o"]})]})]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,sx:{marginTop:4.8,marginBottom:3},children:(0,a.jsxs)(p.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:[(0,a.jsx)(h(),{href:"/members/credit/".concat(z),passHref:!0,children:(0,a.jsx)(j.Z,{size:"large",variant:"outlined",href:"#text-buttons",color:"success",children:"Add Credit"})}),(0,a.jsx)(h(),{href:"/members/profile/edit/".concat(z),passHref:!0,children:(0,a.jsx)(j.Z,{sx:{ml:5},size:"large",variant:"contained",href:"#text-buttons",children:"Edit Profile"})})]})}),(0,a.jsx)(x.ZP,{item:!0,xs:12,children:X&&(0,a.jsx)(g.Z,{severity:"warning",children:(0,a.jsx)(y.Z,{children:X})})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Member Code:"})," ",W.memberCode]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Expiry:"})," ",P(W.expiryDate)]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Email:"})," ",null===(e=W.userInfo[0])||void 0===e?void 0:e.email]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"User Role:"})," ",null===(n=W.userInfo[0])||void 0===n?void 0:n.userRole]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Preferred Name:"})," ",null===(r=W.userInfo[0])||void 0===r?void 0:r.userName]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Phone Number:"})," ",W.phoneNumber]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Regsitration Date:"})," ",P(null===(i=W.userInfo[0])||void 0===i?void 0:i.createdAt)]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Nationality:"})," ",W.nationality]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"ID Type:"})," ",W.idType]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"ID Number:"})," ",W.idNumber]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Date of Birth:"})," ",P(W.dateOfBirth)]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Gender:"})," ",W.gender]})}),(0,a.jsx)(x.ZP,{item:!0,xs:6,children:(0,a.jsxs)(Z.Z,{variant:"body1",children:[(0,a.jsx)(p.Z,{component:"span",sx:{fontWeight:600,color:"text.primary"},children:"Estimated Consumption:"})," ",W.consumption]})})]})})})}),(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(u.Z,{sx:{p:5},children:(0,a.jsxs)(m.Z,{children:[(0,a.jsx)(Z.Z,{variant:"h5",children:"Dispense History"}),(0,a.jsx)(b.Z,{data:_})]})})}),(0,a.jsx)(x.ZP,{item:!0,xs:12,children:(0,a.jsx)(u.Z,{sx:{p:5},children:(0,a.jsxs)(m.Z,{children:[(0,a.jsx)(Z.Z,{variant:"h5",children:"Donation History"}),(0,a.jsx)(v.Z,{data:N})]})})})]})})}},4026:function(e,n,r){"use strict";var t=r(85893),i=r(59496);n.Z=function(e){var n=e.qrLink,r=(0,i.y)().Canvas;return(0,t.jsx)(r,{text:n,options:{level:"M",margin:3,scale:4,width:200,color:{dark:"#000000",light:"#ffffff"}}})}},44960:function(e,n,r){"use strict";var t=r(85893),i=r(67294),s=r(5616),a=r(90629),c=r(7906),o=r(57922),l=r(53816),d=r(53184),h=r(295),x=r(98102),u=r(15861),Z=r(93946),m=r(72882),j=r(23246),p=r(22875),f=function(e){var n=e.row,r=(0,i.useState)(!1),a=r[0],m=r[1];return(0,t.jsxs)(i.Fragment,{children:[(0,t.jsxs)(l.Z,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,t.jsx)(x.Z,{children:(0,t.jsx)(Z.Z,{"aria-label":"expand row",size:"small",onClick:function(){return m(!a)},children:a?(0,t.jsx)(j.Z,{}):(0,t.jsx)(p.Z,{})})}),(0,t.jsx)(x.Z,{children:n.transactionId}),(0,t.jsx)(x.Z,{align:"center",children:n.memberCode}),(0,t.jsx)(x.Z,{align:"center",children:n.transactionType}),(0,t.jsx)(x.Z,{align:"center",children:n.amountTotal}),(0,t.jsx)(x.Z,{align:"center",children:new Date(n.checkoutDate).toLocaleDateString()}),(0,t.jsx)(x.Z,{align:"center",children:n.createdBy})]}),(0,t.jsx)(l.Z,{sx:{background:"#fafafa"},children:(0,t.jsx)(x.Z,{colSpan:7,sx:{py:"0 !important"},children:(0,t.jsx)(o.Z,{in:a,timeout:"auto",unmountOnExit:!0,children:(0,t.jsxs)(s.Z,{sx:{m:2,pb:6},children:[(0,t.jsx)(u.Z,{variant:"body1",gutterBottom:!0,component:"div",sx:{py:2},children:"Products Dispensed"}),(0,t.jsxs)(c.Z,{size:"small","aria-label":"products",children:[(0,t.jsx)(d.Z,{children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(x.Z,{align:"center",children:"Name"}),(0,t.jsx)(x.Z,{align:"center",children:"Category"}),(0,t.jsx)(x.Z,{align:"center",children:"Sale Price"}),(0,t.jsx)(x.Z,{align:"center",children:"Weight"}),(0,t.jsx)(x.Z,{align:"center",children:"Subtotal"})]})}),(0,t.jsx)(h.Z,{children:n.products.map((function(e,n){return(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(x.Z,{align:"center",children:e.name}),(0,t.jsx)(x.Z,{align:"center",children:e.category}),(0,t.jsx)(x.Z,{align:"center",children:e.salePrice}),(0,t.jsx)(x.Z,{align:"center",children:e.weight}),(0,t.jsx)(x.Z,{align:"center",children:e.subtotal})]},n)}))})]}),(0,t.jsx)(u.Z,{variant:"body1",gutterBottom:!0,component:"div",sx:{py:2,mt:4},children:"Comments"}),(0,t.jsx)(u.Z,{variant:"body2",children:n.comments})]})})})})]})};n.Z=function(e){var n=e.data;return n&&Array.isArray(n)&&0!==n.length?(0,t.jsx)(m.Z,{component:a.Z,children:(0,t.jsxs)(c.Z,{"aria-label":"collapsible table",children:[(0,t.jsx)(d.Z,{children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(x.Z,{}),(0,t.jsx)(x.Z,{children:"Transaction ID"}),(0,t.jsx)(x.Z,{align:"center",children:"Member Code"}),(0,t.jsx)(x.Z,{align:"center",children:"Transaction Type"}),(0,t.jsx)(x.Z,{align:"center",children:"Amount Total"}),(0,t.jsx)(x.Z,{align:"center",children:"Checkout Date"}),(0,t.jsx)(x.Z,{align:"center",children:"Created By"})]})}),(0,t.jsx)(h.Z,{children:n.map((function(e){return(0,t.jsx)(f,{row:e},e._id.$oid)}))})]})}):(0,t.jsx)("p",{children:"No data available."})}},75787:function(e,n,r){"use strict";var t=r(85893),i=r(67294),s=r(41664),a=r.n(s),c=r(90629),o=r(7906),l=r(53816),d=r(53184),h=r(295),x=r(98102),u=r(72882),Z=r(70519),m=function(e){if(!e||isNaN(new Date(e)))return"";return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric"})},j=function(e){var n=new Date(e),r=new Date,t=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return i<0||0===i&&r.getDate()<n.getDate()?t-1:t};n.Z=function(e){var n=e.data,r=(0,i.useState)(0),s=r[0],p=r[1],f=(0,i.useState)(5),g=f[0],y=f[1];if(!n||!Array.isArray(n)||0===n.length)return(0,t.jsx)("p",{children:"No data available."});var v=s>0?Math.max(0,(1+s)*g-n.length):0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{component:c.Z,children:(0,t.jsxs)(o.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,t.jsx)(d.Z,{children:(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(x.Z,{children:"ID"}),(0,t.jsx)(x.Z,{children:"First Name"}),(0,t.jsx)(x.Z,{children:"Last Name"}),(0,t.jsx)(x.Z,{children:"Credits"}),(0,t.jsx)(x.Z,{children:"Gender"}),(0,t.jsx)(x.Z,{children:"Registered"}),(0,t.jsx)(x.Z,{children:"Age"}),(0,t.jsx)(x.Z,{children:"ID Number"}),(0,t.jsx)(x.Z,{children:"User Role"}),(0,t.jsx)(x.Z,{children:"Email"}),(0,t.jsx)(x.Z,{children:"Expiry"})]})}),(0,t.jsxs)(h.Z,{children:[n.slice(s*g,s*g+g).map((function(e){var n,r,i;return(0,t.jsx)(a(),{href:"/members/profile/".concat(e.memberCode),passHref:!0,children:(0,t.jsxs)(l.Z,{component:"a",sx:{cursor:"pointer",textDecoration:"none","&:hover":{backgroundColor:"#f5f5f5"},"&:last-of-type td, &:last-of-type th":{border:0}},children:[(0,t.jsx)(x.Z,{component:"th",scope:"row",children:e.memberCode}),(0,t.jsx)(x.Z,{children:e.firstName}),(0,t.jsx)(x.Z,{children:e.lastName}),(0,t.jsx)(x.Z,{children:e.credits}),(0,t.jsx)(x.Z,{children:e.gender}),(0,t.jsx)(x.Z,{children:m(null===(n=e.userInfo[0])||void 0===n?void 0:n.createdAt)}),(0,t.jsx)(x.Z,{children:j(e.dateOfBirth)}),(0,t.jsx)(x.Z,{children:e.idNumber}),(0,t.jsx)(x.Z,{children:null===(r=e.userInfo[0])||void 0===r?void 0:r.userRole}),(0,t.jsx)(x.Z,{children:null===(i=e.userInfo[0])||void 0===i?void 0:i.email}),(0,t.jsx)(x.Z,{children:m(e.expiryDate)})]})},e.memberCode)})),v>0&&(0,t.jsx)(l.Z,{style:{height:53*v},children:(0,t.jsx)(x.Z,{colSpan:11})})]})]})}),(0,t.jsx)(Z.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:n.length,rowsPerPage:g,page:s,onPageChange:function(e,n){p(n)},onRowsPerPageChange:function(e){y(parseInt(e.target.value,10)),p(0)}})]})}},94429:function(e,n,r){"use strict";var t=r(85893),i=(r(67294),r(41664),r(90629)),s=r(7906),a=r(53816),c=r(53184),o=r(295),l=r(98102),d=r(72882),h=function(e){if(!e||isNaN(new Date(e)))return"";return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric"})};n.Z=function(e){var n=e.data;return n&&Array.isArray(n)&&0!==n.length?(0,t.jsx)(d.Z,{component:i.Z,children:(0,t.jsxs)(s.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,t.jsx)(c.Z,{children:(0,t.jsxs)(a.Z,{children:[(0,t.jsx)(l.Z,{children:"ID"}),(0,t.jsx)(l.Z,{children:"Transaction Type"}),(0,t.jsx)(l.Z,{children:"Paid By"}),(0,t.jsx)(l.Z,{children:"Amount"}),(0,t.jsx)(l.Z,{children:"Credit Before"}),(0,t.jsx)(l.Z,{children:"Credit After"}),(0,t.jsx)(l.Z,{children:"Comments"}),(0,t.jsx)(l.Z,{children:"Created By"}),(0,t.jsx)(l.Z,{children:"Transaction Date"})]})}),(0,t.jsx)(o.Z,{children:n.map((function(e){return(0,t.jsxs)(a.Z,{component:"tr",sx:{cursor:"pointer",textDecoration:"none","&:hover":{backgroundColor:"#f5f5f5"},"&:first-of-type td, &:first-of-type th":{border:0}},children:[(0,t.jsx)(l.Z,{component:"th",scope:"row",children:e.transactionId}),(0,t.jsx)(l.Z,{children:e.transactionType}),(0,t.jsx)(l.Z,{children:e.paidBy}),(0,t.jsx)(l.Z,{children:e.amount}),(0,t.jsx)(l.Z,{children:e.creditBefore}),(0,t.jsx)(l.Z,{children:e.creditAfter}),(0,t.jsx)(l.Z,{children:e.comments}),(0,t.jsx)(l.Z,{children:e.createdBy}),(0,t.jsx)(l.Z,{children:h(e.transactionDate)})]},e.transactionId)}))})]})}):(0,t.jsx)("p",{children:"No data available."})}}},function(e){e.O(0,[2657,7709,8360,9254,519,7028,6178,9774,2888,179],(function(){return n=74927,e(e.s=n);var n}));var n=e.O();_N_E=n}]);
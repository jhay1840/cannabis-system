(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5335],{52511:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/members/credit/[memberCode]",function(){return r(39088)}])},86078:function(e,t,r){"use strict";var n=r(47568),a=r(97582),s=r(85893),i=r(11163),c=r(67294),o=r(5121);t.Z=function(e){var t=e.children,r=(0,i.useRouter)();return(0,c.useEffect)((function(){var e=function(){var e=(0,n.Z)((function(){var e,t,n;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(!(e=sessionStorage.getItem("token")))return r.push("/login"),[2];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,o.Z.get("".concat("http://localhost:5000","/api/public/user-type"),{headers:{Authorization:"Bearer ".concat(e)},withCredentials:!0})];case 2:return t=a.sent(),console.log(t.data),"false"===t.data?r.push("/login"):"member"===t.data&&r.push("/user"),[3,4];case 3:return n=a.sent(),console.error("Error checking authentication:",n),r.push("/login"),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}();e()}),[r]),(0,s.jsx)(s.Fragment,{children:t})}},39088:function(e,t,r){"use strict";r.r(t);var n=r(47568),a=r(14924),s=r(97582),i=r(85893),c=r(67294),o=r(5121),l=r(11163),u=r(41664),d=r.n(u),h=r(86886),m=r(50135),x=r(94054),p=r(18360),f=r(47312),Z=r(22224),j=r(66242),g=r(15861),v=r(44267),b=r(69417),y=r(5616),C=r(90948),w=r(94429),P=r(86078),_=(0,C.ZP)("img")((function(e){var t=e.theme;return{width:150,height:150,marginRight:t.spacing(6.25),borderRadius:t.shape.borderRadius}})),B=((0,C.ZP)(b.Z)((function(e){var t=e.theme;return(0,a.Z)({},t.breakpoints.down("sm"),{width:"100%",textAlign:"center"})})),function(e){var t=new Date(e),r=new Date,n=r.getFullYear()-t.getFullYear(),a=r.getMonth()-t.getMonth();return a<0||0===a&&r.getDate()<t.getDate()?n-1:n});t.default=function(){var e=(0,c.useState)([]),t=e[0],r=e[1],a=(0,c.useState)("/images/avatars/1.png"),u=a[0],C=(a[1],(0,c.useState)(null)),D=C[0],S=C[1],k=(0,c.useState)(null),A=k[0],E=k[1],N=(0,c.useState)(""),I=N[0],T=N[1],z=(0,c.useState)(""),R=z[0],q=z[1],M=(0,c.useState)(""),W=M[0],O=M[1],F=(0,c.useState)(null),H=F[0],L=F[1],X=(0,l.useRouter)(),Y="undefined"!==typeof sessionStorage?sessionStorage.getItem("token"):null,G=function(){var e=(0,n.Z)((function(e){var t;return(0,s.__generator)(this,(function(r){switch(r.label){case 0:e.preventDefault(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,o.Z.post("".concat("http://localhost:5000","/api/protected/updateCredits"),{memberCode:A,amount:Number(I),comments:W,paidBy:R},{headers:{Authorization:"Bearer ".concat(Y)},withCredentials:!0})];case 2:return r.sent(),T(""),q(""),O(""),X.push("/dispense/".concat(A)),[3,4];case 3:return t=r.sent(),console.error("Error making donation:",t),L(t.response.data.error),[3,4];case 4:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=(0,n.Z)((function(){var e,t,n,a;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:e=X.query.memberCode,t=e,console.log(t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,o.Z.get("".concat("http://localhost:5000","/api/protected/creditTransactions"),{params:{memberId:t},headers:{Authorization:"Bearer ".concat(Y)},withCredentials:!0})];case 2:return(n=s.sent()).data&&n.data.length>0&&r(n.data),console.log(n.data),[3,4];case 3:return a=s.sent(),console.error("Error fetching transaction data:",a),[3,4];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){var e=function(){var e=(0,n.Z)((function(){var e,t,r;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=X.query.memberCode,[4,o.Z.get("".concat("http://localhost:5000","/api/protected/members/").concat(e),{headers:{Authorization:"Bearer ".concat(Y)},withCredentials:!0})];case 1:return(t=n.sent()).data&&t.data.length>0&&(S(t.data[0]),E(e)),[3,3];case 2:return r=n.sent(),console.error("Error fetching member data:",r),[3,3];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();e(),J()}),[X.query.memberCode]),D?H?(0,i.jsxs)("p",{children:["Error: ",H]}):(0,i.jsx)(P.Z,{children:(0,i.jsxs)(h.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(h.ZP,{item:!0,xs:12,children:(0,i.jsx)(j.Z,{sx:{p:5},children:(0,i.jsx)(v.Z,{children:(0,i.jsxs)(h.ZP,{container:!0,spacing:5,children:[(0,i.jsx)(h.ZP,{item:!0,xs:12,children:(0,i.jsx)(g.Z,{variant:"h5",children:"Make a donation"})}),(0,i.jsx)(h.ZP,{item:!0,xs:6,sx:{marginTop:4.8,marginBottom:10},children:(0,i.jsxs)(y.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,i.jsx)(_,{src:u,alt:"Profile Pic"}),(0,i.jsxs)(y.Z,{children:[(0,i.jsxs)(g.Z,{variant:"h6",children:[D.firstName," ",D.lastName]}),(0,i.jsxs)(g.Z,{variant:"subtitle1",children:["Credits: ",D.credits]}),(0,i.jsxs)(g.Z,{variant:"body2",children:[B(D.dateOfBirth)," y.o"]})]})]})}),(0,i.jsx)(h.ZP,{item:!0,xs:6,sx:{marginTop:4.8,marginBottom:3},children:(0,i.jsx)(y.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end"},children:(0,i.jsx)(d(),{href:"/members/profile/".concat(A),passHref:!0,children:(0,i.jsx)(b.Z,{size:"large",variant:"outlined",color:"error",children:"Cancel"})})})}),(0,i.jsx)(h.ZP,{item:!0,sm:12,children:(0,i.jsxs)("form",{onSubmit:G,style:{display:"flex",gap:"1em",flexWrap:"wrap"},children:[(0,i.jsx)(h.ZP,{item:!0,xs:12,sm:4,children:(0,i.jsx)(m.Z,{fullWidth:!0,label:"Amount",placeholder:"Amount",type:"number",value:I,onChange:function(e){return T(e.target.value)},required:!0})}),(0,i.jsx)(h.ZP,{item:!0,xs:12,sm:4,children:(0,i.jsxs)(x.Z,{fullWidth:!0,children:[(0,i.jsx)(f.Z,{children:"Paid by"}),(0,i.jsxs)(p.Z,{label:"Paid By",value:R,onChange:function(e){return q(e.target.value)},required:!0,children:[(0,i.jsx)(Z.Z,{value:"Cash",children:"Cash"}),(0,i.jsx)(Z.Z,{value:"Card",children:"Card"})]})]})}),(0,i.jsx)(h.ZP,{item:!0,xs:8,children:(0,i.jsx)(m.Z,{fullWidth:!0,label:"Comment",placeholder:"Comment",multiline:!0,value:W,sx:{"& .MuiOutlinedInput-root":{alignItems:"baseline"}},minRows:3,onChange:function(e){return O(e.target.value)}})}),(0,i.jsx)(h.ZP,{item:!0,sm:12,children:(0,i.jsx)(b.Z,{size:"large",variant:"contained",sx:{marginBottom:7},type:"submit",children:"Make Donation"})})]})})]})})})}),(0,i.jsx)(h.ZP,{item:!0,xs:12,children:(0,i.jsx)(j.Z,{sx:{p:5},children:(0,i.jsxs)(v.Z,{children:[(0,i.jsx)(g.Z,{variant:"h5",children:"Donation History"}),(0,i.jsx)(w.Z,{data:t})]})})})]})}):(0,i.jsx)("p",{children:"Loading..."})}},94429:function(e,t,r){"use strict";var n=r(85893),a=(r(67294),r(41664),r(90629)),s=r(7906),i=r(53816),c=r(53184),o=r(295),l=r(98102),u=r(72882),d=function(e){if(!e||isNaN(new Date(e)))return"";return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"numeric",day:"numeric"})};t.Z=function(e){var t=e.data;return t&&Array.isArray(t)&&0!==t.length?(0,n.jsx)(u.Z,{component:a.Z,children:(0,n.jsxs)(s.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,n.jsx)(c.Z,{children:(0,n.jsxs)(i.Z,{children:[(0,n.jsx)(l.Z,{children:"ID"}),(0,n.jsx)(l.Z,{children:"Transaction Type"}),(0,n.jsx)(l.Z,{children:"Paid By"}),(0,n.jsx)(l.Z,{children:"Amount"}),(0,n.jsx)(l.Z,{children:"Credit Before"}),(0,n.jsx)(l.Z,{children:"Credit After"}),(0,n.jsx)(l.Z,{children:"Comments"}),(0,n.jsx)(l.Z,{children:"Created By"}),(0,n.jsx)(l.Z,{children:"Transaction Date"})]})}),(0,n.jsx)(o.Z,{children:t.map((function(e){return(0,n.jsxs)(i.Z,{component:"tr",sx:{cursor:"pointer",textDecoration:"none","&:hover":{backgroundColor:"#f5f5f5"},"&:first-of-type td, &:first-of-type th":{border:0}},children:[(0,n.jsx)(l.Z,{component:"th",scope:"row",children:e.transactionId}),(0,n.jsx)(l.Z,{children:e.transactionType}),(0,n.jsx)(l.Z,{children:e.paidBy}),(0,n.jsx)(l.Z,{children:e.amount}),(0,n.jsx)(l.Z,{children:e.creditBefore}),(0,n.jsx)(l.Z,{children:e.creditAfter}),(0,n.jsx)(l.Z,{children:e.comments}),(0,n.jsx)(l.Z,{children:e.createdBy}),(0,n.jsx)(l.Z,{children:d(e.transactionDate)})]},e.transactionId)}))})]})}):(0,n.jsx)("p",{children:"No data available."})}}},function(e){e.O(0,[2657,7709,8360,3678,9254,8637,9774,2888,179],(function(){return t=52511,e(e.s=t);var t}));var t=e.O();_N_E=t}]);